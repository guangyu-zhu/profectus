-2020-01-22 13:50:31.349 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Starting InterviewApplication on JACKYs-iMac with PID 9819 (/Users/jackyzhu/Downloads/interview/target/classes started by jackyzhu in /Users/jackyzhu/Downloads/interview)
--2020-01-22 13:50:31.351 -DEBUG 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Running with Spring Boot v2.2.4.RELEASE, Spring v5.2.3.RELEASE
--2020-01-22 13:50:31.351 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : The following profiles are active: dev
--2020-01-22 13:50:31.381 - INFO 9819 --- [restartedMain] o.s.b.devtools.restart.ChangeableUrls    : The Class-Path manifest attribute in /Users/jackyzhu/workspace/repoMaven/org/glassfish/jaxb/jaxb-runtime/2.3.2/jaxb-runtime-2.3.2.jar referenced one or more files that do not exist: file:/Users/jackyzhu/workspace/repoMaven/org/glassfish/jaxb/jaxb-runtime/2.3.2/jakarta.xml.bind-api-2.3.2.jar,file:/Users/jackyzhu/workspace/repoMaven/org/glassfish/jaxb/jaxb-runtime/2.3.2/txw2-2.3.2.jar,file:/Users/jackyzhu/workspace/repoMaven/org/glassfish/jaxb/jaxb-runtime/2.3.2/istack-commons-runtime-3.0.8.jar,file:/Users/jackyzhu/workspace/repoMaven/org/glassfish/jaxb/jaxb-runtime/2.3.2/stax-ex-1.8.1.jar,file:/Users/jackyzhu/workspace/repoMaven/org/glassfish/jaxb/jaxb-runtime/2.3.2/FastInfoset-1.2.16.jar,file:/Users/jackyzhu/workspace/repoMaven/org/glassfish/jaxb/jaxb-runtime/2.3.2/jakarta.activation-api-1.2.1.jar
--2020-01-22 13:50:31.382 - INFO 9819 --- [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
--2020-01-22 13:50:31.382 - INFO 9819 --- [restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : For additional web related logging consider setting the 'logging.level.web' property to 'DEBUG'
--2020-01-22 13:50:31.868 - INFO 9819 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
--2020-01-22 13:50:31.921 - INFO 9819 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 47ms. Found 3 JPA repository interfaces.
--2020-01-22 13:50:32.110 - INFO 9819 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
--2020-01-22 13:50:32.275 - INFO 9819 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
--2020-01-22 13:50:32.281 - INFO 9819 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
--2020-01-22 13:50:32.281 - INFO 9819 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.30]
--2020-01-22 13:50:32.432 - INFO 9819 --- [restartedMain] org.apache.jasper.servlet.TldScanner     : At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
--2020-01-22 13:50:32.435 - INFO 9819 --- [restartedMain] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
--2020-01-22 13:50:32.435 - INFO 9819 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1053 ms
--2020-01-22 13:50:32.463 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
--2020-01-22 13:50:32.585 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
--2020-01-22 13:50:32.589 - INFO 9819 --- [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:interview'
--2020-01-22 13:50:32.664 - INFO 9819 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
--2020-01-22 13:50:32.704 - INFO 9819 --- [restartedMain] org.hibernate.Version                    : HHH000412: Hibernate Core {5.4.10.Final}
--2020-01-22 13:50:32.769 - INFO 9819 --- [restartedMain] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
--2020-01-22 13:50:32.827 - INFO 9819 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
--2020-01-22 13:50:33.181 - INFO 9819 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
--2020-01-22 13:50:33.185 - INFO 9819 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
--2020-01-22 13:50:33.204 - INFO 9819 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
--2020-01-22 13:50:33.620 - INFO 9819 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'
--2020-01-22 13:50:33.768 - INFO 9819 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
--2020-01-22 13:50:33.770 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Started InterviewApplication in 2.703 seconds (JVM running for 3.251)
--2020-01-22 13:50:37.045 - INFO 9819 --- [http-nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
--2020-01-22 13:50:37.046 - INFO 9819 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
--2020-01-22 13:50:37.050 - INFO 9819 --- [http-nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
--2020-01-22 13:50:46.371 -DEBUG 9819 --- [http-nio-8080-exec-3] c.p.i.service.impl.CalcServiceImpl       : ready to calc product claim for : ProductClaim(fromDate=2019-12-10, toDate=2020-01-16, productList=[Product(code=A, discount=1.0)])
--2020-01-22 13:50:46.392 -DEBUG 9819 --- [http-nio-8080-exec-3] c.p.i.service.impl.CalcServiceImpl       : product transactionList found: [Sales(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=1000.0), Sales(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=900.0), Sales(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=1200.0)]
--2020-01-22 13:50:46.394 - INFO 9819 --- [http-nio-8080-exec-3] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$1000.0	1.0%	==>	10.0
--2020-01-22 13:50:46.394 - INFO 9819 --- [http-nio-8080-exec-3] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$900.0	1.0%	==>	9.0
--2020-01-22 13:50:46.394 - INFO 9819 --- [http-nio-8080-exec-3] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$1200.0	1.0%	==>	12.0
--2020-01-22 13:50:46.394 - INFO 9819 --- [http-nio-8080-exec-3] c.p.i.s.c.ProductClaimCalculator         : ------------Product claim Total:31.0---------------
--2020-01-22 13:50:52.394 -DEBUG 9819 --- [http-nio-8080-exec-5] c.p.i.service.impl.CalcServiceImpl       : ready to calc tiered claim for : TieredClaim(fromDate=2019-12-09, toDate=2020-01-09)
--2020-01-22 13:50:52.396 -DEBUG 9819 --- [http-nio-8080-exec-5] c.p.i.service.impl.CalcServiceImpl       : tiered transactionList found: [Merchandise(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=50.0), Merchandise(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=1000.0), Merchandise(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=2000.0), Merchandise(pid=4, productCode=B, transactionDate=2020-01-07 00:00:00.0, amount=5000.0)]
--2020-01-22 13:50:52.397 - INFO 9819 --- [http-nio-8080-exec-5] c.p.i.s.c.TieredClaimCalculator          : ------------Total Amount:8050.0---------------
--2020-01-22 13:50:52.401 - INFO 9819 --- [http-nio-8080-exec-5] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 20.0
--2020-01-22 13:50:52.401 - INFO 9819 --- [http-nio-8080-exec-5] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 200.0
--2020-01-22 13:50:52.401 - INFO 9819 --- [http-nio-8080-exec-5] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 228.75
--2020-01-22 13:50:52.401 - INFO 9819 --- [http-nio-8080-exec-5] c.p.i.s.c.TieredClaimCalculator          : ------------Tiered claim Total:448.75---------------
--2020-01-22 13:57:22.828 - INFO 9819 --- [Thread-8] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'applicationTaskExecutor'
--2020-01-22 13:57:22.829 - INFO 9819 --- [Thread-8] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
--2020-01-22 13:57:22.829 - INFO 9819 --- [Thread-8] .SchemaDropperImpl$DelayedDropActionImpl : HHH000477: Starting delayed evictData of schema as part of SessionFactory shut-down'
--2020-01-22 13:57:23.038 - WARN 9819 --- [Thread-8] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-200]
--2020-01-22 13:57:23.038 - INFO 9819 --- [Thread-8] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
--2020-01-22 13:57:23.039 - INFO 9819 --- [Thread-8] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
--2020-01-22 13:57:40.330 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Starting InterviewApplication on JACKYs-iMac with PID 9819 (/Users/jackyzhu/Downloads/interview/target/classes started by jackyzhu in /Users/jackyzhu/Downloads/interview)
--2020-01-22 13:57:40.330 -DEBUG 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Running with Spring Boot v2.2.4.RELEASE, Spring v5.2.3.RELEASE
--2020-01-22 13:57:40.330 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : The following profiles are active: dev
--2020-01-22 13:57:40.413 - INFO 9819 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
--2020-01-22 13:57:40.414 - INFO 9819 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 0ms. Found 0 JPA repository interfaces.
--2020-01-22 13:57:40.444 - INFO 9819 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
--2020-01-22 13:57:40.479 - INFO 9819 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
--2020-01-22 13:57:40.479 - INFO 9819 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
--2020-01-22 13:57:40.479 - INFO 9819 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.30]
--2020-01-22 13:57:40.538 - INFO 9819 --- [restartedMain] org.apache.jasper.servlet.TldScanner     : At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
--2020-01-22 13:57:40.539 - INFO 9819 --- [restartedMain] o.a.c.c.C.[Tomcat-1].[localhost].[/]     : Initializing Spring embedded WebApplicationContext
--2020-01-22 13:57:40.539 - INFO 9819 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 207 ms
--2020-01-22 13:57:40.551 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Starting...
--2020-01-22 13:57:40.553 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Start completed.
--2020-01-22 13:57:40.553 - INFO 9819 --- [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:interview'
--2020-01-22 13:57:40.573 - INFO 9819 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
--2020-01-22 13:57:40.578 - INFO 9819 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
--2020-01-22 13:57:40.588 - INFO 9819 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
--2020-01-22 13:57:40.588 - INFO 9819 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
--2020-01-22 13:57:40.598 - INFO 9819 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
--2020-01-22 13:57:40.601 - WARN 9819 --- [restartedMain] ConfigServletWebServerApplicationContext : Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of URL [file:/Users/jackyzhu/Downloads/interview/target/classes/data.sql]: insert into sales(pid, product_code, transaction_date, sale_amount) values (1, 'A', '2019-12-17', 1000); nested exception is org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "SALES" not found; SQL statement:
insert into sales(pid, product_code, transaction_date, sale_amount) values (1, 'A', '2019-12-17', 1000) [42102-200]
--2020-01-22 13:57:40.805 - WARN 9819 --- [restartedMain] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-200]
--2020-01-22 13:57:40.805 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Shutdown initiated...
--2020-01-22 13:57:40.905 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-3 - Shutdown completed.
--2020-01-22 13:57:40.905 - INFO 9819 --- [restartedMain] o.apache.catalina.core.StandardService   : Stopping service [Tomcat]
--2020-01-22 13:57:40.910 - INFO 9819 --- [restartedMain] ConditionEvaluationReportLoggingListener : 

Error starting ApplicationContext. To display the conditions report re-run your application with 'debug' enabled.
--2020-01-22 13:57:40.911 -ERROR 9819 --- [restartedMain] o.s.boot.SpringApplication               : Application run failed
-
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in class path resource [org/springframework/boot/autoconfigure/orm/jpa/HibernateJpaConfiguration.class]: Initialization of bean failed; nested exception is org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of URL [file:/Users/jackyzhu/Downloads/interview/target/classes/data.sql]: insert into sales(pid, product_code, transaction_date, sale_amount) values (1, 'A', '2019-12-17', 1000); nested exception is org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "SALES" not found; SQL statement:
insert into sales(pid, product_code, transaction_date, sale_amount) values (1, 'A', '2019-12-17', 1000) [42102-200]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:603) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:517) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:323) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:321) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:202) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1108) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:868) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:550) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:141) ~[spring-boot-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:747) [spring-boot-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397) [spring-boot-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:315) [spring-boot-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1226) [spring-boot-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1215) [spring-boot-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at com.profectus.interview.InterviewApplication.main(InterviewApplication.java:10) [classes/:na]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_181]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_181]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_181]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_181]
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49) [spring-boot-devtools-2.2.4.RELEASE.jar:2.2.4.RELEASE]
Caused by: org.springframework.jdbc.datasource.init.ScriptStatementFailedException: Failed to execute SQL script statement #1 of URL [file:/Users/jackyzhu/Downloads/interview/target/classes/data.sql]: insert into sales(pid, product_code, transaction_date, sale_amount) values (1, 'A', '2019-12-17', 1000); nested exception is org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "SALES" not found; SQL statement:
insert into sales(pid, product_code, transaction_date, sale_amount) values (1, 'A', '2019-12-17', 1000) [42102-200]
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:626) ~[spring-jdbc-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.jdbc.datasource.init.ResourceDatabasePopulator.populate(ResourceDatabasePopulator.java:254) ~[spring-jdbc-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.jdbc.datasource.init.DatabasePopulatorUtils.execute(DatabasePopulatorUtils.java:49) ~[spring-jdbc-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.boot.autoconfigure.jdbc.DataSourceInitializer.runScripts(DataSourceInitializer.java:202) ~[spring-boot-autoconfigure-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.autoconfigure.jdbc.DataSourceInitializer.initSchema(DataSourceInitializer.java:119) ~[spring-boot-autoconfigure-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.autoconfigure.jdbc.DataSourceInitializerInvoker.onApplicationEvent(DataSourceInitializerInvoker.java:91) ~[spring-boot-autoconfigure-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.autoconfigure.jdbc.DataSourceInitializerInvoker.onApplicationEvent(DataSourceInitializerInvoker.java:38) ~[spring-boot-autoconfigure-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.doInvokeListener(SimpleApplicationEventMulticaster.java:172) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.invokeListener(SimpleApplicationEventMulticaster.java:165) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:139) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:403) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:360) ~[spring-context-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.boot.autoconfigure.orm.jpa.DataSourceInitializedPublisher.publishEventIfRequired(DataSourceInitializedPublisher.java:99) ~[spring-boot-autoconfigure-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.boot.autoconfigure.orm.jpa.DataSourceInitializedPublisher.postProcessAfterInitialization(DataSourceInitializedPublisher.java:90) ~[spring-boot-autoconfigure-2.2.4.RELEASE.jar:2.2.4.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:431) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1800) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:595) ~[spring-beans-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	... 20 common frames omitted
Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Table "SALES" not found; SQL statement:
insert into sales(pid, product_code, transaction_date, sale_amount) values (1, 'A', '2019-12-17', 1000) [42102-200]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:453) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:429) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.message.DbException.get(DbException.java:205) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.message.DbException.get(DbException.java:181) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.command.Parser.readTableOrView(Parser.java:7628) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.command.Parser.readTableOrView(Parser.java:7599) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.command.Parser.parseInsert(Parser.java:1747) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.command.Parser.parsePrepared(Parser.java:954) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.command.Parser.parse(Parser.java:843) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.command.Parser.parse(Parser.java:815) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.command.Parser.prepareCommand(Parser.java:738) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.engine.Session.prepareLocal(Session.java:657) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.engine.Session.prepareCommand(Session.java:595) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1235) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.jdbc.JdbcStatement.executeInternal(JdbcStatement.java:212) ~[h2-1.4.200.jar:1.4.200]
	at org.h2.jdbc.JdbcStatement.execute(JdbcStatement.java:201) ~[h2-1.4.200.jar:1.4.200]
	at com.zaxxer.hikari.pool.ProxyStatement.execute(ProxyStatement.java:95) ~[HikariCP-3.4.2.jar:na]
	at com.zaxxer.hikari.pool.HikariProxyStatement.execute(HikariProxyStatement.java) ~[HikariCP-3.4.2.jar:na]
	at org.springframework.jdbc.datasource.init.ScriptUtils.executeSqlScript(ScriptUtils.java:605) ~[spring-jdbc-5.2.3.RELEASE.jar:5.2.3.RELEASE]
	... 36 common frames omitted

-2020-01-22 13:57:42.345 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Starting InterviewApplication on JACKYs-iMac with PID 9819 (/Users/jackyzhu/Downloads/interview/target/classes started by jackyzhu in /Users/jackyzhu/Downloads/interview)
--2020-01-22 13:57:42.345 -DEBUG 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Running with Spring Boot v2.2.4.RELEASE, Spring v5.2.3.RELEASE
--2020-01-22 13:57:42.346 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : The following profiles are active: dev
--2020-01-22 13:57:42.490 - INFO 9819 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
--2020-01-22 13:57:42.501 - INFO 9819 --- [restartedMain] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 11ms. Found 3 JPA repository interfaces.
--2020-01-22 13:57:42.534 - INFO 9819 --- [restartedMain] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
--2020-01-22 13:57:42.593 - INFO 9819 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
--2020-01-22 13:57:42.593 - INFO 9819 --- [restartedMain] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
--2020-01-22 13:57:42.594 - INFO 9819 --- [restartedMain] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.30]
--2020-01-22 13:57:42.636 - INFO 9819 --- [restartedMain] org.apache.jasper.servlet.TldScanner     : At least one JAR was scanned for TLDs yet contained no TLDs. Enable debug logging for this logger for a complete list of JARs that were scanned but no TLDs were found in them. Skipping unneeded JARs during scanning can improve startup time and JSP compilation time.
--2020-01-22 13:57:42.636 - INFO 9819 --- [restartedMain] o.a.c.c.C.[Tomcat-2].[localhost].[/]     : Initializing Spring embedded WebApplicationContext
--2020-01-22 13:57:42.636 - INFO 9819 --- [restartedMain] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 288 ms
--2020-01-22 13:57:42.647 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Starting...
--2020-01-22 13:57:42.648 - INFO 9819 --- [restartedMain] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Start completed.
--2020-01-22 13:57:42.648 - INFO 9819 --- [restartedMain] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:interview'
--2020-01-22 13:57:42.666 - INFO 9819 --- [restartedMain] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
--2020-01-22 13:57:42.670 - INFO 9819 --- [restartedMain] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
--2020-01-22 13:57:42.720 - INFO 9819 --- [restartedMain] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
--2020-01-22 13:57:42.720 - INFO 9819 --- [restartedMain] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
--2020-01-22 13:57:42.726 - INFO 9819 --- [restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
--2020-01-22 13:57:42.825 - INFO 9819 --- [restartedMain] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'
--2020-01-22 13:57:42.873 - INFO 9819 --- [restartedMain] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
--2020-01-22 13:57:42.873 - INFO 9819 --- [restartedMain] c.p.interview.InterviewApplication       : Started InterviewApplication in 0.551 seconds (JVM running for 432.357)
--2020-01-22 13:57:42.875 - INFO 9819 --- [restartedMain] .ConditionEvaluationDeltaLoggingListener : Condition evaluation unchanged
--2020-01-22 13:57:43.298 - INFO 10121 --- [main] c.p.interview.InterviewApplicationTests  : Starting InterviewApplicationTests on JACKYs-iMac with PID 10121 (started by jackyzhu in /Users/jackyzhu/Downloads/interview)
--2020-01-22 13:57:43.299 -DEBUG 10121 --- [main] c.p.interview.InterviewApplicationTests  : Running with Spring Boot v2.2.4.RELEASE, Spring v5.2.3.RELEASE
--2020-01-22 13:57:43.299 - INFO 10121 --- [main] c.p.interview.InterviewApplicationTests  : The following profiles are active: dev
--2020-01-22 13:57:43.726 - INFO 10121 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
--2020-01-22 13:57:43.785 - INFO 10121 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 51ms. Found 3 JPA repository interfaces.
--2020-01-22 13:57:44.049 - INFO 10121 --- [main] trationDelegate$BeanPostProcessorChecker : Bean 'org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration' of type [org.springframework.transaction.annotation.ProxyTransactionManagementConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
--2020-01-22 13:57:44.165 - INFO 10121 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
--2020-01-22 13:57:44.368 - INFO 10121 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
--2020-01-22 13:57:44.420 - INFO 10121 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
--2020-01-22 13:57:44.471 - INFO 10121 --- [main] org.hibernate.Version                    : HHH000412: Hibernate Core {5.4.10.Final}
--2020-01-22 13:57:44.565 - INFO 10121 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.0.Final}
--2020-01-22 13:57:44.653 - INFO 10121 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.H2Dialect
--2020-01-22 13:57:45.155 - INFO 10121 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
--2020-01-22 13:57:45.160 - INFO 10121 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
--2020-01-22 13:57:46.039 - INFO 10121 --- [main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService 'applicationTaskExecutor'
--2020-01-22 13:57:46.237 - INFO 10121 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:h2:mem:interview'
--2020-01-22 13:57:46.298 - INFO 10121 --- [main] c.p.interview.InterviewApplicationTests  : Started InterviewApplicationTests in 3.281 seconds (JVM running for 4.068)
--2020-01-22 13:57:46.372 - INFO 10121 --- [main] .b.t.c.SpringBootTestContextBootstrapper : Neither @ContextConfiguration nor @ContextHierarchy found for test class [com.profectus.interview.service.CalcServiceTest], using SpringBootContextLoader
--2020-01-22 13:57:46.372 - INFO 10121 --- [main] o.s.t.c.support.AbstractContextLoader    : Could not detect default resource locations for test class [com.profectus.interview.service.CalcServiceTest]: no resource found for suffixes {-context.xml, Context.groovy}.
--2020-01-22 13:57:46.373 - INFO 10121 --- [main] t.c.s.AnnotationConfigContextLoaderUtils : Could not detect default configuration classes for test class [com.profectus.interview.service.CalcServiceTest]: CalcServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
--2020-01-22 13:57:46.377 - INFO 10121 --- [main] .b.t.c.SpringBootTestContextBootstrapper : Found @SpringBootConfiguration com.profectus.interview.InterviewApplication for test class com.profectus.interview.service.CalcServiceTest
--2020-01-22 13:57:46.379 - INFO 10121 --- [main] .b.t.c.SpringBootTestContextBootstrapper : Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener, org.springframework.test.context.event.EventPublishingTestExecutionListener]
--2020-01-22 13:57:46.379 - INFO 10121 --- [main] .b.t.c.SpringBootTestContextBootstrapper : Using TestExecutionListeners: [org.springframework.test.context.web.ServletTestExecutionListener@2a075e70, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@492c9892, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@533e2f4, org.springframework.boot.test.autoconfigure.SpringBootDependencyInjectionTestExecutionListener@436a563f, org.springframework.test.context.support.DirtiesContextTestExecutionListener@538e74fc, org.springframework.test.context.transaction.TransactionalTestExecutionListener@7ecb9e17, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@6475e778, org.springframework.test.context.event.EventPublishingTestExecutionListener@75bf9e67, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@55b62db8, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@772f3a3f, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@3caa4d85, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@356fa0d1, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@51508029]
--2020-01-22 13:57:46.388 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : ready to calc product claim for : ProductClaim(fromDate=2019-12-17, toDate=2019-12-29, productList=[Product(code=A, discount=10.0), Product(code=B, discount=10.0)])
--2020-01-22 13:57:46.430 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : product transactionList found: [Sales(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=1000.0), Sales(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=900.0), Sales(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=1200.0)]
--2020-01-22 13:57:46.432 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$1000.0	10.0%	==>	100.0
--2020-01-22 13:57:46.432 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$900.0	10.0%	==>	90.0
--2020-01-22 13:57:46.432 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$1200.0	10.0%	==>	120.0
--2020-01-22 13:57:46.432 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : ------------Product claim Total:310.0---------------
--2020-01-22 13:57:46.486 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : ready to calc tiered claim for : TieredClaim(fromDate=2019-12-17, toDate=2019-12-27)
--2020-01-22 13:57:46.488 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : tiered transactionList found: [Merchandise(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=50.0), Merchandise(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=1000.0), Merchandise(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=2000.0)]
--2020-01-22 13:57:46.489 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : ------------Total Amount:3050.0---------------
--2020-01-22 13:57:46.494 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 20.0
--2020-01-22 13:57:46.494 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 102.5
--2020-01-22 13:57:46.494 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : ------------Tiered claim Total:122.5---------------
--2020-01-22 13:57:46.498 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : ready to calc tiered claim for : TieredClaim(fromDate=2019-12-17, toDate=2020-01-09)
--2020-01-22 13:57:46.500 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : tiered transactionList found: [Sales(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=1000.0), Sales(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=900.0), Sales(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=1200.0), Sales(pid=4, productCode=B, transactionDate=2020-01-07 00:00:00.0, amount=1300.0), Sales(pid=5, productCode=C, transactionDate=2020-01-09 00:00:00.0, amount=4000.0)]
--2020-01-22 13:57:46.501 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : ------------Total Amount:8400.0---------------
--2020-01-22 13:57:46.501 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 20.0
--2020-01-22 13:57:46.502 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 200.0
--2020-01-22 13:57:46.502 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 255.0
--2020-01-22 13:57:46.503 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : ------------Tiered claim Total:475.0---------------
--2020-01-22 13:57:46.507 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : ready to calc product claim for : ProductClaim(fromDate=2019-12-17, toDate=2020-01-19, productList=[Product(code=A, discount=10.0), Product(code=B, discount=20.0), Product(code=C, discount=30.0)])
--2020-01-22 13:57:46.512 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : product transactionList found: [Merchandise(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=50.0), Merchandise(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=1000.0), Merchandise(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=2000.0), Merchandise(pid=4, productCode=B, transactionDate=2020-01-07 00:00:00.0, amount=5000.0), Merchandise(pid=5, productCode=C, transactionDate=2020-01-19 00:00:00.0, amount=2550.0)]
--2020-01-22 13:57:46.512 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$50.0	10.0%	==>	5.0
--2020-01-22 13:57:46.512 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$1000.0	10.0%	==>	100.0
--2020-01-22 13:57:46.512 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$2000.0	10.0%	==>	200.0
--2020-01-22 13:57:46.512 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: B	$5000.0	20.0%	==>	1000.0
--2020-01-22 13:57:46.512 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: C	$2550.0	30.0%	==>	765.0
--2020-01-22 13:57:46.512 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : ------------Product claim Total:2070.0---------------
--2020-01-22 13:57:46.517 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : ready to calc product claim for : ProductClaim(fromDate=2019-12-17, toDate=2020-01-09, productList=[Product(code=A, discount=10.0), Product(code=B, discount=20.0), Product(code=C, discount=30.0)])
--2020-01-22 13:57:46.521 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : product transactionList found: [Sales(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=1000.0), Sales(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=900.0), Sales(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=1200.0), Sales(pid=4, productCode=B, transactionDate=2020-01-07 00:00:00.0, amount=1300.0), Sales(pid=5, productCode=C, transactionDate=2020-01-09 00:00:00.0, amount=4000.0)]
--2020-01-22 13:57:46.521 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$1000.0	10.0%	==>	100.0
--2020-01-22 13:57:46.521 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$900.0	10.0%	==>	90.0
--2020-01-22 13:57:46.521 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: A	$1200.0	10.0%	==>	120.0
--2020-01-22 13:57:46.521 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: B	$1300.0	20.0%	==>	260.0
--2020-01-22 13:57:46.522 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : productCode: C	$4000.0	30.0%	==>	1200.0
--2020-01-22 13:57:46.522 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : ------------Product claim Total:1770.0---------------
--2020-01-22 13:57:46.527 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : ready to calc product claim for : ProductClaim(fromDate=2019-12-17, toDate=2019-12-29, productList=[Product(code=B, discount=10.0), Product(code=C, discount=10.0)])
--2020-01-22 13:57:46.530 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : product transactionList found: []
--2020-01-22 13:57:46.530 - INFO 10121 --- [main] c.p.i.s.c.ProductClaimCalculator         : ------------Product claim Total:0.0---------------
--2020-01-22 13:57:46.535 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : ready to calc tiered claim for : TieredClaim(fromDate=2019-12-17, toDate=2020-01-09)
--2020-01-22 13:57:46.537 -DEBUG 10121 --- [main] c.p.i.service.impl.CalcServiceImpl       : tiered transactionList found: [Merchandise(pid=1, productCode=A, transactionDate=2019-12-17 00:00:00.0, amount=50.0), Merchandise(pid=2, productCode=A, transactionDate=2019-12-18 00:00:00.0, amount=1000.0), Merchandise(pid=3, productCode=A, transactionDate=2019-12-27 00:00:00.0, amount=2000.0), Merchandise(pid=4, productCode=B, transactionDate=2020-01-07 00:00:00.0, amount=5000.0)]
--2020-01-22 13:57:46.538 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : ------------Total Amount:8050.0---------------
--2020-01-22 13:57:46.538 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 20.0
--2020-01-22 13:57:46.538 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 200.0
--2020-01-22 13:57:46.538 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : subTotal after discount: 228.75
--2020-01-22 13:57:46.538 - INFO 10121 --- [main] c.p.i.s.c.TieredClaimCalculator          : ------------Tiered claim Total:448.75---------------
--2020-01-22 13:57:46.548 - INFO 10121 --- [SpringContextShutdownHook] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'applicationTaskExecutor'
--2020-01-22 13:57:46.549 - INFO 10121 --- [SpringContextShutdownHook] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
--2020-01-22 13:57:46.549 - INFO 10121 --- [SpringContextShutdownHook] .SchemaDropperImpl$DelayedDropActionImpl : HHH000477: Starting delayed evictData of schema as part of SessionFactory shut-down'
--2020-01-22 13:57:46.551 - WARN 10121 --- [SpringContextShutdownHook] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 90121, SQLState: 90121
--2020-01-22 13:57:46.551 -ERROR 10121 --- [SpringContextShutdownHook] o.h.engine.jdbc.spi.SqlExceptionHelper   : Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-200]
--2020-01-22 13:57:46.551 - WARN 10121 --- [SpringContextShutdownHook] o.h.engine.jdbc.spi.SqlExceptionHelper   : SQL Error: 90121, SQLState: 90121
--2020-01-22 13:57:46.552 -ERROR 10121 --- [SpringContextShutdownHook] o.h.engine.jdbc.spi.SqlExceptionHelper   : Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-200]
--2020-01-22 13:57:46.552 - WARN 10121 --- [SpringContextShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'entityManagerFactory': org.hibernate.exception.JDBCConnectionException: Unable to release JDBC Connection used for DDL execution
--2020-01-22 13:57:46.552 - INFO 10121 --- [SpringContextShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown initiated...
--2020-01-22 13:57:46.554 - INFO 10121 --- [SpringContextShutdownHook] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Shutdown completed.
--2020-01-22 13:57:53.324 - INFO 9819 --- [Thread-17] o.s.s.concurrent.ThreadPoolTaskExecutor  : Shutting down ExecutorService 'applicationTaskExecutor'
--2020-01-22 13:57:53.324 - INFO 9819 --- [Thread-17] j.LocalContainerEntityManagerFactoryBean : Closing JPA EntityManagerFactory for persistence unit 'default'
--2020-01-22 13:57:53.325 - INFO 9819 --- [Thread-17] .SchemaDropperImpl$DelayedDropActionImpl : HHH000477: Starting delayed evictData of schema as part of SessionFactory shut-down'
--2020-01-22 13:57:53.531 - WARN 9819 --- [Thread-17] o.s.b.f.support.DisposableBeanAdapter    : Invocation of destroy method failed on bean with name 'inMemoryDatabaseShutdownExecutor': org.h2.jdbc.JdbcSQLNonTransientConnectionException: Database is already closed (to disable automatic closing at VM shutdown, add ";DB_CLOSE_ON_EXIT=FALSE" to the db URL) [90121-200]
--2020-01-22 13:57:53.532 - INFO 9819 --- [Thread-17] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Shutdown initiated...
--2020-01-22 13:57:53.533 - INFO 9819 --- [Thread-17] com.zaxxer.hikari.HikariDataSource       : HikariPool-4 - Shutdown completed.
-